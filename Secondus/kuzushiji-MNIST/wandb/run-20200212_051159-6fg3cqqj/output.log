Scaling input data...
Max value: 255.0
Number of classes in this dataset: 10
One hot encoding targets...
Original input shape: (28, 28, 1)
2020-02-11 21:12:01.117231: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-11 21:12:01.138020: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fae8ebbe0a0 executing computations on platform Host. Devices:
2020-02-11 21:12:01.138041: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 26, 26, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 24, 32)        9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 10, 10, 64)        18496     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 1600)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               204928    
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 10)                1290      
=================================================================
Total params: 234,282
Trainable params: 234,282
Non-trainable params: 0
_________________________________________________________________
Train on 60000 samples, validate on 10000 samples
Epoch 1/100
 - 45s - loss: 0.3802 - accuracy: 0.8820 - val_loss: 0.3350 - val_accuracy: 0.8997
roc-auc: 0.9992 - roc-auc_val: 0.9926                                                                                                    

Epoch 00001: val_loss improved from inf to 0.33496, saving model to /Users/mitsukakiyohara/GitHub/ATCS_y4_-mitsukakiyohara/Secondus/kuzushiji-MNIST/kmnist_weights.hdf5
Epoch 2/100
 - 46s - loss: 0.1227 - accuracy: 0.9634 - val_loss: 0.2397 - val_accuracy: 0.9284
roc-auc: 0.9997 - roc-auc_val: 0.9961                                                                                                    

Epoch 00002: val_loss improved from 0.33496 to 0.23968, saving model to /Users/mitsukakiyohara/GitHub/ATCS_y4_-mitsukakiyohara/Secondus/kuzushiji-MNIST/kmnist_weights.hdf5
Epoch 3/100
 - 44s - loss: 0.0778 - accuracy: 0.9767 - val_loss: 0.1974 - val_accuracy: 0.9450
roc-auc: 0.9999 - roc-auc_val: 0.9971                                                                                                    

Epoch 00003: val_loss improved from 0.23968 to 0.19740, saving model to /Users/mitsukakiyohara/GitHub/ATCS_y4_-mitsukakiyohara/Secondus/kuzushiji-MNIST/kmnist_weights.hdf5
Epoch 4/100
 - 48s - loss: 0.0572 - accuracy: 0.9826 - val_loss: 0.2029 - val_accuracy: 0.9427
roc-auc: 1.0 - roc-auc_val: 0.9971                                                                                                    

Epoch 00004: val_loss did not improve from 0.19740
Epoch 5/100
 - 45s - loss: 0.0459 - accuracy: 0.9854 - val_loss: 0.1808 - val_accuracy: 0.9508
roc-auc: 1.0 - roc-auc_val: 0.9979                                                                                                    

Epoch 00005: val_loss improved from 0.19740 to 0.18084, saving model to /Users/mitsukakiyohara/GitHub/ATCS_y4_-mitsukakiyohara/Secondus/kuzushiji-MNIST/kmnist_weights.hdf5
Epoch 6/100
 - 46s - loss: 0.0346 - accuracy: 0.9889 - val_loss: 0.1769 - val_accuracy: 0.9567
roc-auc: 1.0 - roc-auc_val: 0.998                                                                                                    

Epoch 00006: val_loss improved from 0.18084 to 0.17694, saving model to /Users/mitsukakiyohara/GitHub/ATCS_y4_-mitsukakiyohara/Secondus/kuzushiji-MNIST/kmnist_weights.hdf5
Epoch 7/100
 - 50s - loss: 0.0296 - accuracy: 0.9903 - val_loss: 0.1758 - val_accuracy: 0.9547
roc-auc: 1.0 - roc-auc_val: 0.998                                                                                                    

Epoch 00007: val_loss improved from 0.17694 to 0.17583, saving model to /Users/mitsukakiyohara/GitHub/ATCS_y4_-mitsukakiyohara/Secondus/kuzushiji-MNIST/kmnist_weights.hdf5
Epoch 8/100
 - 49s - loss: 0.0243 - accuracy: 0.9919 - val_loss: 0.1856 - val_accuracy: 0.9587
roc-auc: 1.0 - roc-auc_val: 0.9982                                                                                                    

Epoch 00008: val_loss did not improve from 0.17583
Epoch 9/100
 - 49s - loss: 0.0224 - accuracy: 0.9925 - val_loss: 0.1773 - val_accuracy: 0.9629
roc-auc: 1.0 - roc-auc_val: 0.9982                                                                                                    

Epoch 00009: val_loss did not improve from 0.17583
Epoch 10/100
 - 46s - loss: 0.0202 - accuracy: 0.9932 - val_loss: 0.1829 - val_accuracy: 0.9609
roc-auc: 1.0 - roc-auc_val: 0.9981                                                                                                    

Epoch 00010: val_loss did not improve from 0.17583
Epoch 11/100
 - 46s - loss: 0.0170 - accuracy: 0.9942 - val_loss: 0.1811 - val_accuracy: 0.9647
roc-auc: 1.0 - roc-auc_val: 0.9982                                                                                                    

Epoch 00011: val_loss did not improve from 0.17583
Epoch 12/100
 - 44s - loss: 0.0166 - accuracy: 0.9943 - val_loss: 0.1754 - val_accuracy: 0.9632
roc-auc: 1.0 - roc-auc_val: 0.9983                                                                                                    

Epoch 00012: val_loss improved from 0.17583 to 0.17542, saving model to /Users/mitsukakiyohara/GitHub/ATCS_y4_-mitsukakiyohara/Secondus/kuzushiji-MNIST/kmnist_weights.hdf5
Epoch 13/100
 - 45s - loss: 0.0140 - accuracy: 0.9950 - val_loss: 0.1823 - val_accuracy: 0.9633
roc-auc: 1.0 - roc-auc_val: 0.9983                                                                                                    

Epoch 00013: val_loss did not improve from 0.17542
Epoch 14/100
 - 44s - loss: 0.0127 - accuracy: 0.9957 - val_loss: 0.1881 - val_accuracy: 0.9648
roc-auc: 1.0 - roc-auc_val: 0.9983                                                                                                    

Epoch 00014: val_loss did not improve from 0.17542
Epoch 15/100
 - 46s - loss: 0.0143 - accuracy: 0.9951 - val_loss: 0.1845 - val_accuracy: 0.9640
roc-auc: 1.0 - roc-auc_val: 0.9985                                                                                                    

Epoch 00015: val_loss did not improve from 0.17542
Epoch 16/100
 - 45s - loss: 0.0115 - accuracy: 0.9961 - val_loss: 0.2050 - val_accuracy: 0.9581
roc-auc: 1.0 - roc-auc_val: 0.9984                                                                                                    

Epoch 00016: val_loss did not improve from 0.17542
Epoch 17/100
 - 44s - loss: 0.0114 - accuracy: 0.9961 - val_loss: 0.2003 - val_accuracy: 0.9634
roc-auc: 1.0 - roc-auc_val: 0.9983                                                                                                    

Epoch 00017: val_loss did not improve from 0.17542
Epoch 18/100
 - 47s - loss: 0.0099 - accuracy: 0.9965 - val_loss: 0.2080 - val_accuracy: 0.9617
roc-auc: 1.0 - roc-auc_val: 0.9984                                                                                                    

Epoch 00018: val_loss did not improve from 0.17542
Epoch 19/100
 - 44s - loss: 0.0097 - accuracy: 0.9967 - val_loss: 0.2070 - val_accuracy: 0.9637
roc-auc: 1.0 - roc-auc_val: 0.9985                                                                                                    

Epoch 00019: val_loss did not improve from 0.17542
Epoch 20/100
 - 46s - loss: 0.0107 - accuracy: 0.9965 - val_loss: 0.2204 - val_accuracy: 0.9647
roc-auc: 1.0 - roc-auc_val: 0.9982                                                                                                    

Epoch 00020: val_loss did not improve from 0.17542
Epoch 21/100
 - 43s - loss: 0.0101 - accuracy: 0.9966 - val_loss: 0.2046 - val_accuracy: 0.9628
roc-auc: 1.0 - roc-auc_val: 0.9985                                                                                                    

Epoch 00021: val_loss did not improve from 0.17542
Epoch 22/100
 - 42s - loss: 0.0098 - accuracy: 0.9966 - val_loss: 0.1986 - val_accuracy: 0.9654
roc-auc: 1.0 - roc-auc_val: 0.9985                                                                                                    

Epoch 00022: val_loss did not improve from 0.17542

Test accuracy: 0.965399980545044
